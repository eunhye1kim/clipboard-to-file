Request url: https://superset.autobi.s-core.co.kr/api/v1/security/login
Request payload: {'username': 'admin', 'password': 'admin', 'provider': 'db', 'refresh': True}
Response: <Response [200]>
Database connection successful.
Request url: https://superset.autobi.s-core.co.kr/api/v1/dataset/
Response: {'count': 18, 'description_columns': {}, 'ids': [110, 89, 72, 82, 73, 90, 80, 83, 91, 106, 92, 94, 107, 86, 95, 108, 87, 109], 'label_columns': {'changed_by.first_name': 'Changed By First Name', 'changed_by.last_name': 'Changed By Last Name', 'changed_by_name': 'Changed By Name', 'changed_on_delta_humanized': 'Changed On Delta Humanized', 'changed_on_utc': 'Changed On Utc', 'database.database_name': 'Database Database Name', 'database.id': 'Database Id', 'datasource_type': 'Datasource Type', 'default_endpoint': 'Default Endpoint', 'description': 'Description', 'explore_url': 'Explore Url', 'extra': 'Extra', 'id': 'Id', 'kind': 'Kind', 'owners.first_name': 'Owners First Name', 'owners.id': 'Owners Id', 'owners.last_name': 'Owners Last Name', 'schema': 'Schema', 'sql': 'Sql', 'table_name': 'Table Name'}, 'list_columns': ['id', 'database.id', 'database.database_name', 'changed_by_name', 'changed_by.first_name', 'changed_by.last_name', 'changed_on_utc', 'changed_on_delta_humanized', 'default_endpoint', 'description', 'datasource_type', 'explore_url', 'extra', 'kind', 'owners.id', 'owners.first_name', 'owners.last_name', 'schema', 'sql', 'table_name'], 'list_title': 'List Sqla Table', 'order_columns': ['table_name', 'schema', 'changed_by.first_name', 'changed_on_delta_humanized', 'database.database_name'], 'result': [{'changed_by': {'first_name': 'Superset', 'last_name': 'Admin'}, 'changed_by_name': 'Superset Admin', 'changed_on_delta_humanized': '2 days ago', 'changed_on_utc': '2024-10-11T09:01:29.899591+0000', 'database': {'database_name': 'PostgreSQL', 'id': 1}, 'datasource_type': 'table', 'default_endpoint': None, 'description': None, 'explore_url': '/explore/?datasource_type=table&datasource_id=110', 'extra': None, 'id': 110, 'kind': 'virtual', 'owners': [{'first_name': 'Superset', 'id': 1, 'last_name': 'Admin'}], 'schema': 'public', 'sql': "SELECT analysis_week, category, summary, volume FROM proc_esg_weekly_summary WHERE analysis_month = '2024-01';", 'table_name': '2024년 1월 ESG 소셜 데이터 주간 추세 분석 결과'}, {'changed_by': {'first_name': 'Superset', 'last_name': 'Admin'}, 'changed_by_name': 'Superset Admin', 'changed_on_delta_humanized': '2 months ago', 'changed_on_utc': '2024-07-17T05:31:23.529097+0000', 'database': {'database_name': 'PostgreSQL', 'id': 1}, 'datasource_type': 'table', 'default_endpoint': None, 'description': None, 'explore_url': '/explore/?datasource_type=table&datasource_id=89', 'extra': None, 'id': 89, 'kind': 'virtual', 'owners': [{'first_name': 'Superset', 'id': 1, 'last_name': 'Admin'}], 'schema': 'public', 'sql': 'SELECT\n  label,\n  value,\n  period,\n  analysis_month,\n  analysis_week\nFROM (\n  SELECT\n    \'environmental\' AS label,\n    environmental AS value,\n    "period",\n    analysis_month,\n    analysis_week\n  FROM public.raw_esg_volume\n  WHERE environmental IS NOT NULL\n  UNION ALL\n  SELECT\n    \'social\' AS label,\n    social AS value,\n    "period",\n    analysis_month,\n    analysis_week\n  FROM public.raw_esg_volume\n  WHERE social IS NOT NULL\n  UNION ALL\n    SELECT\n    \'governance\' AS label,\n    governance AS value,\n    "period",\n    analysis_month,\n    analysis_week\n  FROM public.raw_esg_volume\n  WHERE governance IS NOT NULL\n)', 'table_name': 'SOV of ESG'}, {'changed_by': {'first_name': 'Superset', 'last_name': 'Admin'}, 'changed_by_name': 'Superset Admin', 'changed_on_delta_humanized': '4 months ago', 'changed_on_utc': '2024-05-29T06:13:09.408203+0000', 'database': {'database_name': 'PostgreSQL', 'id': 1}, 'datasource_type': 'table', 'default_endpoint': None, 'description': None, 'explore_url': '/explore/?datasource_type=table&datasource_id=72', 'extra': None, 'id': 72, 'kind': 'physical', 'owners': [{'first_name': 'Superset', 'id': 1, 'last_name': 'Admin'}], 'schema': 'public', 'sql': None, 'table_name': 'raw_esg_volume'}, {'changed_by': {'first_name': 'Superset', 'last_name': 'Admin'}, 'changed_by_name': 'Superset Admin', 'changed_on_delta_humanized': '2 months ago', 'changed_on_utc': '2024-07-17T05:32:46.056558+0000', 'database': {'database_name': 'PostgreSQL', 'id': 1}, 'datasource_type': 'table', 'default_endpoint': None, 'description': None, 'explore_url': '/explore/?datasource_type=table&datasource_id=82', 'extra': None, 'id': 82, 'kind': 'virtual', 'owners': [{'first_name': 'Superset', 'id': 1, 'last_name': 'Admin'}], 'schema': 'public', 'sql': 'SELECT\n  label,\n  value,\n  period,\n  analysis_month,\n  analysis_week\nFROM (\n  SELECT\n    \'environmental\' AS label,\n    environmental AS value,\n    "period",\n    analysis_month,\n    analysis_week\n  FROM public.raw_esg_volume_pos_neg_diff\n  WHERE environmental IS NOT NULL\n  UNION ALL\n  SELECT\n    \'social\' AS label,\n    social AS value,\n    "period",\n    analysis_month,\n    analysis_week\n  FROM public.raw_esg_volume_pos_neg_diff\n  WHERE social IS NOT NULL\n  UNION ALL\n    SELECT\n    \'governance\' AS label,\n    governance AS value,\n    "period",\n    analysis_month,\n    analysis_week\n  FROM public.raw_esg_volume_pos_neg_diff \n  WHERE governance IS NOT NULL\n)', 'table_name': 'Sentimental difference of ESG '}, {'changed_by': {'first_name': 'Superset', 'last_name': 'Admin'}, 'changed_by_name': 'Superset Admin', 'changed_on_delta_humanized': '4 months ago', 'changed_on_utc': '2024-05-29T07:14:06.538568+0000', 'database': {'database_name': 'PostgreSQL', 'id': 1}, 'datasource_type': 'table', 'default_endpoint': None, 'description': None, 'explore_url': '/explore/?datasource_type=table&datasource_id=73', 'extra': None, 'id': 73, 'kind': 'virtual', 'owners': [{'first_name': 'Superset', 'id': 1, 'last_name': 'Admin'}], 'schema': 'public', 'sql': "SELECT\r\n    analysis_week,\r\n    category,\r\n    summary,\r\n    volume\r\nFROM\r\n    proc_esg_weekly_summary\r\nWHERE\r\n    category IN ('Environmental', 'Social', 'Governance')\r\n    AND analysis_week = (\r\n        SELECT MAX(analysis_week)\r\n        FROM proc_esg_weekly_summary\r\n    );", 'table_name': 'Query egs_social'}, {'changed_by': {'first_name': 'Superset', 'last_name': 'Admin'}, 'changed_by_name': 'Superset Admin', 'changed_on_delta_humanized': '2 months ago', 'changed_on_utc': '2024-07-23T05:40:13.550530+0000', 'database': {'database_name': 'PostgreSQL', 'id': 1}, 'datasource_type': 'table', 'default_endpoint': None, 'description': None, 'explore_url': '/explore/?datasource_type=table&datasource_id=90', 'extra': None, 'id': 90, 'kind': 'virtual', 'owners': [{'first_name': 'Superset', 'id': 1, 'last_name': 'Admin'}], 'schema': 'public', 'sql': "--CREATE TABLE stop_words (\r\n--    word text\r\n--);\r\n\r\n---- 불용어 추가 (예시)\r\n--INSERT INTO stop_words (word) VALUES \r\n--('the'), ('and'), ('is'), ('in'), ('to'), ('of'), ('a'), ('with'), ('that'), ('on'), ('for'), ('as'), ('by'), ('an'), ('at'), ('from'), ('it'), ('this'), ('be'), ('are'), ('or'), ('was'), ('but'), ('not'), ('we'), ('which'), ('has'), ('have'), ('also'), ('their'), ('more'), ('they'), ('our'), ('will'), ('its'), ('these'), ('can'), ('than'), ('such'), ('other'), ('been'), ('would'), ('should'), ('could'), ('may'), ('might'), ('into'), ('any'), ('all'), ('no'), ('one'), ('were'), ('about'), ('what'), ('when'), ('there'), ('who'), ('how'), ('if'), ('out'), ('up'), ('so'), ('he'), ('she'), ('his'), ('her'), ('them'), ('us'), ('had'), ('do'), ('did'), ('only'), ('some'), ('we'), ('they'), ('you'), ('your'), ('yours'), ('theirs'), ('those'), ('many'), ('few'), ('new'), ('most'), ('over'), ('now'), ('still'), ('after'), ('first'), ('even'), ('like'), ('said'), ('say'), ('just'), ('make'), ('made'), ('because'), ('being'), ('during'), ('before'), ('while'), ('since'), ('where'), ('who'), ('whose'), ('whom'), ('come'), ('comes'), ('got'), ('go'), ('goes'), ('went'), ('going'), ('gone'), ('get'), ('gets'), ('getting'), ('gotten');\r\n\r\n\r\nWITH raw_data AS (\r\n    SELECT title || ' ' || summary AS text\r\n    FROM public.raw_esg_cluster\r\n), \r\nsplit_words AS (\r\n    SELECT unnest(string_to_array(lower(text), ' ')) AS word\r\n    FROM raw_data\r\n),\r\ncleaned_words AS (\r\n    SELECT word\r\n    FROM split_words\r\n    WHERE word NOT IN (SELECT word FROM stop_words)\r\n    AND word ~ '^[a-z]+$'  -- 영어 단어만 선택 (필요시 조정 가능)\r\n)\r\nSELECT word, COUNT(*) as frequency\r\nFROM cleaned_words\r\nGROUP BY word\r\nORDER BY frequency desc", 'table_name': 'word_map'}, {'changed_by': {'first_name': 'Superset', 'last_name': 'Admin'}, 'changed_by_name': 'Superset Admin', 'changed_on_delta_humanized': '3 months ago', 'changed_on_utc': '2024-07-01T08:52:59.698433+0000', 'database': {'database_name': 'PostgreSQL', 'id': 1}, 'datasource_type': 'table', 'default_endpoint': None, 'description': None, 'explore_url': '/explore/?datasource_type=table&datasource_id=80', 'extra': None, 'id': 80, 'kind': 'physical', 'owners': [{'first_name': 'Superset', 'id': 1, 'last_name': 'Admin'}], 'schema': 'public', 'sql': None, 'table_name': 'raw_esg_volume_pos_neg_diff'}, {'changed_by': {'first_name': 'Superset', 'last_name': 'Admin'}, 'changed_by_name': 'Superset Admin', 'changed_on_delta_humanized': '2 months ago', 'changed_on_utc': '2024-07-15T13:34:49.293295+0000', 'database': {'database_name': 'PostgreSQL', 'id': 1}, 'datasource_type': 'table', 'default_endpoint': None, 'description': None, 'explore_url': '/explore/?datasource_type=table&datasource_id=83', 'extra': None, 'id': 83, 'kind': 'physical', 'owners': [{'first_name': 'Superset', 'id': 1, 'last_name': 'Admin'}], 'schema': 'public', 'sql': None, 'table_name': 'raw_esg_cluster'}, {'changed_by': {'first_name': 'Superset', 'last_name': 'Admin'}, 'changed_by_name': 'Superset Admin', 'changed_on_delta_humanized': '2 months ago', 'changed_on_utc': '2024-07-29T14:02:20.981855+0000', 'database': {'database_name': 'PostgreSQL', 'id': 1}, 'datasource_type': 'table', 'default_endpoint': None, 'description': None, 'explore_url': '/explore/?datasource_type=table&datasource_id=91', 'extra': None, 'id': 91, 'kind': 'physical', 'owners': [{'first_name': 'Superset', 'id': 1, 'last_name': 'Admin'}], 'schema': 'public', 'sql': None, 'table_name': 'proc_esg_weekly_summary'}, {'changed_by': {'first_name': 'Superset', 'last_name': 'Admin'}, 'changed_by_name': 'Superset Admin', 'changed_on_delta_humanized': 'a month ago', 'changed_on_utc': '2024-08-26T13:07:06.330059+0000', 'database': {'database_name': 'PostgreSQL', 'id': 1}, 'datasource_type': 'table', 'default_endpoint': None, 'description': None, 'explore_url': '/explore/?datasource_type=table&datasource_id=106', 'extra': None, 'id': 106, 'kind': 'physical', 'owners': [{'first_name': 'Superset', 'id': 1, 'last_name': 'Admin'}], 'schema': 'public', 'sql': None, 'table_name': 'esg_monthly_change_analysis'}, {'changed_by': {'first_name': 'Superset', 'last_name': 'Admin'}, 'changed_by_name': 'Superset Admin', 'changed_on_delta_humanized': '2 months ago', 'changed_on_utc': '2024-07-29T14:03:00.397942+0000', 'database': {'database_name': 'PostgreSQL', 'id': 1}, 'datasource_type': 'table', 'default_endpoint': None, 'description': None, 'explore_url': '/explore/?datasource_type=table&datasource_id=92', 'extra': None, 'id': 92, 'kind': 'physical', 'owners': [{'first_name': 'Superset', 'id': 1, 'last_name': 'Admin'}], 'schema': 'public', 'sql': None, 'table_name': 'proc_esg_monthly_summary'}, {'changed_by': {'first_name': 'Superset', 'last_name': 'Admin'}, 'changed_by_name': 'Superset Admin', 'changed_on_delta_humanized': 'a month ago', 'changed_on_utc': '2024-08-14T08:55:21.803532+0000', 'database': {'database_name': 'PostgreSQL', 'id': 1}, 'datasource_type': 'table', 'default_endpoint': None, 'description': None, 'explore_url': '/explore/?datasource_type=table&datasource_id=94', 'extra': None, 'id': 94, 'kind': 'physical', 'owners': [{'first_name': 'Superset', 'id': 1, 'last_name': 'Admin'}], 'schema': 'public', 'sql': None, 'table_name': 'raw_esg_volume_positive'}, {'changed_by': {'first_name': 'Superset', 'last_name': 'Admin'}, 'changed_by_name': 'Superset Admin', 'changed_on_delta_humanized': 'a month ago', 'changed_on_utc': '2024-08-26T13:07:06.588035+0000', 'database': {'database_name': 'PostgreSQL', 'id': 1}, 'datasource_type': 'table', 'default_endpoint': None, 'description': None, 'explore_url': '/explore/?datasource_type=table&datasource_id=107', 'extra': None, 'id': 107, 'kind': 'physical', 'owners': [{'first_name': 'Superset', 'id': 1, 'last_name': 'Admin'}], 'schema': 'public', 'sql': None, 'table_name': 'esg_weekly_change_analysis'}, {'changed_by': {'first_name': 'Superset', 'last_name': 'Admin'}, 'changed_by_name': 'Superset Admin', 'changed_on_delta_humanized': '2 months ago', 'changed_on_utc': '2024-07-16T10:37:40.106258+0000', 'database': {'database_name': 'PostgreSQL', 'id': 1}, 'datasource_type': 'table', 'default_endpoint': None, 'description': None, 'explore_url': '/explore/?datasource_type=table&datasource_id=86', 'extra': None, 'id': 86, 'kind': 'physical', 'owners': [{'first_name': 'Superset', 'id': 1, 'last_name': 'Admin'}], 'schema': 'public', 'sql': None, 'table_name': 'esg_brand_volume'}, {'changed_by': {'first_name': 'Superset', 'last_name': 'Admin'}, 'changed_by_name': 'Superset Admin', 'changed_on_delta_humanized': 'a month ago', 'changed_on_utc': '2024-08-14T08:55:58.174543+0000', 'database': {'database_name': 'PostgreSQL', 'id': 1}, 'datasource_type': 'table', 'default_endpoint': None, 'description': None, 'explore_url': '/explore/?datasource_type=table&datasource_id=95', 'extra': None, 'id': 95, 'kind': 'physical', 'owners': [{'first_name': 'Superset', 'id': 1, 'last_name': 'Admin'}], 'schema': 'public', 'sql': None, 'table_name': 'raw_esg_volume_negative'}, {'changed_by': {'first_name': 'Superset', 'last_name': 'Admin'}, 'changed_by_name': 'Superset Admin', 'changed_on_delta_humanized': 'a month ago', 'changed_on_utc': '2024-08-26T14:05:41.423056+0000', 'database': {'database_name': 'PostgreSQL', 'id': 1}, 'datasource_type': 'table', 'default_endpoint': None, 'description': None, 'explore_url': '/explore/?datasource_type=table&datasource_id=108', 'extra': None, 'id': 108, 'kind': 'physical', 'owners': [{'first_name': 'Superset', 'id': 1, 'last_name': 'Admin'}], 'schema': 'public', 'sql': None, 'table_name': 'esg_category_values'}, {'changed_by': {'first_name': 'Superset', 'last_name': 'Admin'}, 'changed_by_name': 'Superset Admin', 'changed_on_delta_humanized': '2 months ago', 'changed_on_utc': '2024-07-16T11:26:21.593718+0000', 'database': {'database_name': 'PostgreSQL', 'id': 1}, 'datasource_type': 'table', 'default_endpoint': None, 'description': None, 'explore_url': '/explore/?datasource_type=table&datasource_id=87', 'extra': None, 'id': 87, 'kind': 'physical', 'owners': [{'first_name': 'Superset', 'id': 1, 'last_name': 'Admin'}], 'schema': 'public', 'sql': None, 'table_name': 'esg_industry_view'}, {'changed_by': {'first_name': 'Superset', 'last_name': 'Admin'}, 'changed_by_name': 'Superset Admin', 'changed_on_delta_humanized': 'a month ago', 'changed_on_utc': '2024-08-27T05:14:31.886180+0000', 'database': {'database_name': 'PostgreSQL', 'id': 1}, 'datasource_type': 'table', 'default_endpoint': None, 'description': None, 'explore_url': '/explore/?datasource_type=table&datasource_id=109', 'extra': None, 'id': 109, 'kind': 'virtual', 'owners': [{'first_name': 'Superset', 'id': 1, 'last_name': 'Admin'}], 'schema': 'public', 'sql': "SELECT analysis_month, category, SUM(volume) as total_volume             FROM proc_esg_monthly_summary             WHERE analysis_month IN ('2024-03', '2024-04') AND category IN ('Environmental', 'Social', 'Governance')             GROUP BY analysis_month, category             ORDER BY analysis_month, category;", 'table_name': '2024년 3월과 4월 EGS 데이터 분석: 환경, 사회, 거버넌스 항목의 바차트 시각화'}]}
Request url: https://superset.autobi.s-core.co.kr/api/v1/dataset/
Response: {'count': 18, 'description_columns': {}, 'ids': [110, 89, 72, 82, 73, 90, 80, 83, 91, 106, 92, 94, 107, 86, 95, 108, 87, 109], 'label_columns': {'changed_by.first_name': 'Changed By First Name', 'changed_by.last_name': 'Changed By Last Name', 'changed_by_name': 'Changed By Name', 'changed_on_delta_humanized': 'Changed On Delta Humanized', 'changed_on_utc': 'Changed On Utc', 'database.database_name': 'Database Database Name', 'database.id': 'Database Id', 'datasource_type': 'Datasource Type', 'default_endpoint': 'Default Endpoint', 'description': 'Description', 'explore_url': 'Explore Url', 'extra': 'Extra', 'id': 'Id', 'kind': 'Kind', 'owners.first_name': 'Owners First Name', 'owners.id': 'Owners Id', 'owners.last_name': 'Owners Last Name', 'schema': 'Schema', 'sql': 'Sql', 'table_name': 'Table Name'}, 'list_columns': ['id', 'database.id', 'database.database_name', 'changed_by_name', 'changed_by.first_name', 'changed_by.last_name', 'changed_on_utc', 'changed_on_delta_humanized', 'default_endpoint', 'description', 'datasource_type', 'explore_url', 'extra', 'kind', 'owners.id', 'owners.first_name', 'owners.last_name', 'schema', 'sql', 'table_name'], 'list_title': 'List Sqla Table', 'order_columns': ['table_name', 'schema', 'changed_by.first_name', 'changed_on_delta_humanized', 'database.database_name'], 'result': [{'changed_by': {'first_name': 'Superset', 'last_name': 'Admin'}, 'changed_by_name': 'Superset Admin', 'changed_on_delta_humanized': '2 days ago', 'changed_on_utc': '2024-10-11T09:01:29.899591+0000', 'database': {'database_name': 'PostgreSQL', 'id': 1}, 'datasource_type': 'table', 'default_endpoint': None, 'description': None, 'explore_url': '/explore/?datasource_type=table&datasource_id=110', 'extra': None, 'id': 110, 'kind': 'virtual', 'owners': [{'first_name': 'Superset', 'id': 1, 'last_name': 'Admin'}], 'schema': 'public', 'sql': "SELECT analysis_week, category, summary, volume FROM proc_esg_weekly_summary WHERE analysis_month = '2024-01';", 'table_name': '2024년 1월 ESG 소셜 데이터 주간 추세 분석 결과'}, {'changed_by': {'first_name': 'Superset', 'last_name': 'Admin'}, 'changed_by_name': 'Superset Admin', 'changed_on_delta_humanized': '2 months ago', 'changed_on_utc': '2024-07-17T05:31:23.529097+0000', 'database': {'database_name': 'PostgreSQL', 'id': 1}, 'datasource_type': 'table', 'default_endpoint': None, 'description': None, 'explore_url': '/explore/?datasource_type=table&datasource_id=89', 'extra': None, 'id': 89, 'kind': 'virtual', 'owners': [{'first_name': 'Superset', 'id': 1, 'last_name': 'Admin'}], 'schema': 'public', 'sql': 'SELECT\n  label,\n  value,\n  period,\n  analysis_month,\n  analysis_week\nFROM (\n  SELECT\n    \'environmental\' AS label,\n    environmental AS value,\n    "period",\n    analysis_month,\n    analysis_week\n  FROM public.raw_esg_volume\n  WHERE environmental IS NOT NULL\n  UNION ALL\n  SELECT\n    \'social\' AS label,\n    social AS value,\n    "period",\n    analysis_month,\n    analysis_week\n  FROM public.raw_esg_volume\n  WHERE social IS NOT NULL\n  UNION ALL\n    SELECT\n    \'governance\' AS label,\n    governance AS value,\n    "period",\n    analysis_month,\n    analysis_week\n  FROM public.raw_esg_volume\n  WHERE governance IS NOT NULL\n)', 'table_name': 'SOV of ESG'}, {'changed_by': {'first_name': 'Superset', 'last_name': 'Admin'}, 'changed_by_name': 'Superset Admin', 'changed_on_delta_humanized': '4 months ago', 'changed_on_utc': '2024-05-29T06:13:09.408203+0000', 'database': {'database_name': 'PostgreSQL', 'id': 1}, 'datasource_type': 'table', 'default_endpoint': None, 'description': None, 'explore_url': '/explore/?datasource_type=table&datasource_id=72', 'extra': None, 'id': 72, 'kind': 'physical', 'owners': [{'first_name': 'Superset', 'id': 1, 'last_name': 'Admin'}], 'schema': 'public', 'sql': None, 'table_name': 'raw_esg_volume'}, {'changed_by': {'first_name': 'Superset', 'last_name': 'Admin'}, 'changed_by_name': 'Superset Admin', 'changed_on_delta_humanized': '2 months ago', 'changed_on_utc': '2024-07-17T05:32:46.056558+0000', 'database': {'database_name': 'PostgreSQL', 'id': 1}, 'datasource_type': 'table', 'default_endpoint': None, 'description': None, 'explore_url': '/explore/?datasource_type=table&datasource_id=82', 'extra': None, 'id': 82, 'kind': 'virtual', 'owners': [{'first_name': 'Superset', 'id': 1, 'last_name': 'Admin'}], 'schema': 'public', 'sql': 'SELECT\n  label,\n  value,\n  period,\n  analysis_month,\n  analysis_week\nFROM (\n  SELECT\n    \'environmental\' AS label,\n    environmental AS value,\n    "period",\n    analysis_month,\n    analysis_week\n  FROM public.raw_esg_volume_pos_neg_diff\n  WHERE environmental IS NOT NULL\n  UNION ALL\n  SELECT\n    \'social\' AS label,\n    social AS value,\n    "period",\n    analysis_month,\n    analysis_week\n  FROM public.raw_esg_volume_pos_neg_diff\n  WHERE social IS NOT NULL\n  UNION ALL\n    SELECT\n    \'governance\' AS label,\n    governance AS value,\n    "period",\n    analysis_month,\n    analysis_week\n  FROM public.raw_esg_volume_pos_neg_diff \n  WHERE governance IS NOT NULL\n)', 'table_name': 'Sentimental difference of ESG '}, {'changed_by': {'first_name': 'Superset', 'last_name': 'Admin'}, 'changed_by_name': 'Superset Admin', 'changed_on_delta_humanized': '4 months ago', 'changed_on_utc': '2024-05-29T07:14:06.538568+0000', 'database': {'database_name': 'PostgreSQL', 'id': 1}, 'datasource_type': 'table', 'default_endpoint': None, 'description': None, 'explore_url': '/explore/?datasource_type=table&datasource_id=73', 'extra': None, 'id': 73, 'kind': 'virtual', 'owners': [{'first_name': 'Superset', 'id': 1, 'last_name': 'Admin'}], 'schema': 'public', 'sql': "SELECT\r\n    analysis_week,\r\n    category,\r\n    summary,\r\n    volume\r\nFROM\r\n    proc_esg_weekly_summary\r\nWHERE\r\n    category IN ('Environmental', 'Social', 'Governance')\r\n    AND analysis_week = (\r\n        SELECT MAX(analysis_week)\r\n        FROM proc_esg_weekly_summary\r\n    );", 'table_name': 'Query egs_social'}, {'changed_by': {'first_name': 'Superset', 'last_name': 'Admin'}, 'changed_by_name': 'Superset Admin', 'changed_on_delta_humanized': '2 months ago', 'changed_on_utc': '2024-07-23T05:40:13.550530+0000', 'database': {'database_name': 'PostgreSQL', 'id': 1}, 'datasource_type': 'table', 'default_endpoint': None, 'description': None, 'explore_url': '/explore/?datasource_type=table&datasource_id=90', 'extra': None, 'id': 90, 'kind': 'virtual', 'owners': [{'first_name': 'Superset', 'id': 1, 'last_name': 'Admin'}], 'schema': 'public', 'sql': "--CREATE TABLE stop_words (\r\n--    word text\r\n--);\r\n\r\n---- 불용어 추가 (예시)\r\n--INSERT INTO stop_words (word) VALUES \r\n--('the'), ('and'), ('is'), ('in'), ('to'), ('of'), ('a'), ('with'), ('that'), ('on'), ('for'), ('as'), ('by'), ('an'), ('at'), ('from'), ('it'), ('this'), ('be'), ('are'), ('or'), ('was'), ('but'), ('not'), ('we'), ('which'), ('has'), ('have'), ('also'), ('their'), ('more'), ('they'), ('our'), ('will'), ('its'), ('these'), ('can'), ('than'), ('such'), ('other'), ('been'), ('would'), ('should'), ('could'), ('may'), ('might'), ('into'), ('any'), ('all'), ('no'), ('one'), ('were'), ('about'), ('what'), ('when'), ('there'), ('who'), ('how'), ('if'), ('out'), ('up'), ('so'), ('he'), ('she'), ('his'), ('her'), ('them'), ('us'), ('had'), ('do'), ('did'), ('only'), ('some'), ('we'), ('they'), ('you'), ('your'), ('yours'), ('theirs'), ('those'), ('many'), ('few'), ('new'), ('most'), ('over'), ('now'), ('still'), ('after'), ('first'), ('even'), ('like'), ('said'), ('say'), ('just'), ('make'), ('made'), ('because'), ('being'), ('during'), ('before'), ('while'), ('since'), ('where'), ('who'), ('whose'), ('whom'), ('come'), ('comes'), ('got'), ('go'), ('goes'), ('went'), ('going'), ('gone'), ('get'), ('gets'), ('getting'), ('gotten');\r\n\r\n\r\nWITH raw_data AS (\r\n    SELECT title || ' ' || summary AS text\r\n    FROM public.raw_esg_cluster\r\n), \r\nsplit_words AS (\r\n    SELECT unnest(string_to_array(lower(text), ' ')) AS word\r\n    FROM raw_data\r\n),\r\ncleaned_words AS (\r\n    SELECT word\r\n    FROM split_words\r\n    WHERE word NOT IN (SELECT word FROM stop_words)\r\n    AND word ~ '^[a-z]+$'  -- 영어 단어만 선택 (필요시 조정 가능)\r\n)\r\nSELECT word, COUNT(*) as frequency\r\nFROM cleaned_words\r\nGROUP BY word\r\nORDER BY frequency desc", 'table_name': 'word_map'}, {'changed_by': {'first_name': 'Superset', 'last_name': 'Admin'}, 'changed_by_name': 'Superset Admin', 'changed_on_delta_humanized': '3 months ago', 'changed_on_utc': '2024-07-01T08:52:59.698433+0000', 'database': {'database_name': 'PostgreSQL', 'id': 1}, 'datasource_type': 'table', 'default_endpoint': None, 'description': None, 'explore_url': '/explore/?datasource_type=table&datasource_id=80', 'extra': None, 'id': 80, 'kind': 'physical', 'owners': [{'first_name': 'Superset', 'id': 1, 'last_name': 'Admin'}], 'schema': 'public', 'sql': None, 'table_name': 'raw_esg_volume_pos_neg_diff'}, {'changed_by': {'first_name': 'Superset', 'last_name': 'Admin'}, 'changed_by_name': 'Superset Admin', 'changed_on_delta_humanized': '2 months ago', 'changed_on_utc': '2024-07-15T13:34:49.293295+0000', 'database': {'database_name': 'PostgreSQL', 'id': 1}, 'datasource_type': 'table', 'default_endpoint': None, 'description': None, 'explore_url': '/explore/?datasource_type=table&datasource_id=83', 'extra': None, 'id': 83, 'kind': 'physical', 'owners': [{'first_name': 'Superset', 'id': 1, 'last_name': 'Admin'}], 'schema': 'public', 'sql': None, 'table_name': 'raw_esg_cluster'}, {'changed_by': {'first_name': 'Superset', 'last_name': 'Admin'}, 'changed_by_name': 'Superset Admin', 'changed_on_delta_humanized': '2 months ago', 'changed_on_utc': '2024-07-29T14:02:20.981855+0000', 'database': {'database_name': 'PostgreSQL', 'id': 1}, 'datasource_type': 'table', 'default_endpoint': None, 'description': None, 'explore_url': '/explore/?datasource_type=table&datasource_id=91', 'extra': None, 'id': 91, 'kind': 'physical', 'owners': [{'first_name': 'Superset', 'id': 1, 'last_name': 'Admin'}], 'schema': 'public', 'sql': None, 'table_name': 'proc_esg_weekly_summary'}, {'changed_by': {'first_name': 'Superset', 'last_name': 'Admin'}, 'changed_by_name': 'Superset Admin', 'changed_on_delta_humanized': 'a month ago', 'changed_on_utc': '2024-08-26T13:07:06.330059+0000', 'database': {'database_name': 'PostgreSQL', 'id': 1}, 'datasource_type': 'table', 'default_endpoint': None, 'description': None, 'explore_url': '/explore/?datasource_type=table&datasource_id=106', 'extra': None, 'id': 106, 'kind': 'physical', 'owners': [{'first_name': 'Superset', 'id': 1, 'last_name': 'Admin'}], 'schema': 'public', 'sql': None, 'table_name': 'esg_monthly_change_analysis'}, {'changed_by': {'first_name': 'Superset', 'last_name': 'Admin'}, 'changed_by_name': 'Superset Admin', 'changed_on_delta_humanized': '2 months ago', 'changed_on_utc': '2024-07-29T14:03:00.397942+0000', 'database': {'database_name': 'PostgreSQL', 'id': 1}, 'datasource_type': 'table', 'default_endpoint': None, 'description': None, 'explore_url': '/explore/?datasource_type=table&datasource_id=92', 'extra': None, 'id': 92, 'kind': 'physical', 'owners': [{'first_name': 'Superset', 'id': 1, 'last_name': 'Admin'}], 'schema': 'public', 'sql': None, 'table_name': 'proc_esg_monthly_summary'}, {'changed_by': {'first_name': 'Superset', 'last_name': 'Admin'}, 'changed_by_name': 'Superset Admin', 'changed_on_delta_humanized': 'a month ago', 'changed_on_utc': '2024-08-14T08:55:21.803532+0000', 'database': {'database_name': 'PostgreSQL', 'id': 1}, 'datasource_type': 'table', 'default_endpoint': None, 'description': None, 'explore_url': '/explore/?datasource_type=table&datasource_id=94', 'extra': None, 'id': 94, 'kind': 'physical', 'owners': [{'first_name': 'Superset', 'id': 1, 'last_name': 'Admin'}], 'schema': 'public', 'sql': None, 'table_name': 'raw_esg_volume_positive'}, {'changed_by': {'first_name': 'Superset', 'last_name': 'Admin'}, 'changed_by_name': 'Superset Admin', 'changed_on_delta_humanized': 'a month ago', 'changed_on_utc': '2024-08-26T13:07:06.588035+0000', 'database': {'database_name': 'PostgreSQL', 'id': 1}, 'datasource_type': 'table', 'default_endpoint': None, 'description': None, 'explore_url': '/explore/?datasource_type=table&datasource_id=107', 'extra': None, 'id': 107, 'kind': 'physical', 'owners': [{'first_name': 'Superset', 'id': 1, 'last_name': 'Admin'}], 'schema': 'public', 'sql': None, 'table_name': 'esg_weekly_change_analysis'}, {'changed_by': {'first_name': 'Superset', 'last_name': 'Admin'}, 'changed_by_name': 'Superset Admin', 'changed_on_delta_humanized': '2 months ago', 'changed_on_utc': '2024-07-16T10:37:40.106258+0000', 'database': {'database_name': 'PostgreSQL', 'id': 1}, 'datasource_type': 'table', 'default_endpoint': None, 'description': None, 'explore_url': '/explore/?datasource_type=table&datasource_id=86', 'extra': None, 'id': 86, 'kind': 'physical', 'owners': [{'first_name': 'Superset', 'id': 1, 'last_name': 'Admin'}], 'schema': 'public', 'sql': None, 'table_name': 'esg_brand_volume'}, {'changed_by': {'first_name': 'Superset', 'last_name': 'Admin'}, 'changed_by_name': 'Superset Admin', 'changed_on_delta_humanized': 'a month ago', 'changed_on_utc': '2024-08-14T08:55:58.174543+0000', 'database': {'database_name': 'PostgreSQL', 'id': 1}, 'datasource_type': 'table', 'default_endpoint': None, 'description': None, 'explore_url': '/explore/?datasource_type=table&datasource_id=95', 'extra': None, 'id': 95, 'kind': 'physical', 'owners': [{'first_name': 'Superset', 'id': 1, 'last_name': 'Admin'}], 'schema': 'public', 'sql': None, 'table_name': 'raw_esg_volume_negative'}, {'changed_by': {'first_name': 'Superset', 'last_name': 'Admin'}, 'changed_by_name': 'Superset Admin', 'changed_on_delta_humanized': 'a month ago', 'changed_on_utc': '2024-08-26T14:05:41.423056+0000', 'database': {'database_name': 'PostgreSQL', 'id': 1}, 'datasource_type': 'table', 'default_endpoint': None, 'description': None, 'explore_url': '/explore/?datasource_type=table&datasource_id=108', 'extra': None, 'id': 108, 'kind': 'physical', 'owners': [{'first_name': 'Superset', 'id': 1, 'last_name': 'Admin'}], 'schema': 'public', 'sql': None, 'table_name': 'esg_category_values'}, {'changed_by': {'first_name': 'Superset', 'last_name': 'Admin'}, 'changed_by_name': 'Superset Admin', 'changed_on_delta_humanized': '2 months ago', 'changed_on_utc': '2024-07-16T11:26:21.593718+0000', 'database': {'database_name': 'PostgreSQL', 'id': 1}, 'datasource_type': 'table', 'default_endpoint': None, 'description': None, 'explore_url': '/explore/?datasource_type=table&datasource_id=87', 'extra': None, 'id': 87, 'kind': 'physical', 'owners': [{'first_name': 'Superset', 'id': 1, 'last_name': 'Admin'}], 'schema': 'public', 'sql': None, 'table_name': 'esg_industry_view'}, {'changed_by': {'first_name': 'Superset', 'last_name': 'Admin'}, 'changed_by_name': 'Superset Admin', 'changed_on_delta_humanized': 'a month ago', 'changed_on_utc': '2024-08-27T05:14:31.886180+0000', 'database': {'database_name': 'PostgreSQL', 'id': 1}, 'datasource_type': 'table', 'default_endpoint': None, 'description': None, 'explore_url': '/explore/?datasource_type=table&datasource_id=109', 'extra': None, 'id': 109, 'kind': 'virtual', 'owners': [{'first_name': 'Superset', 'id': 1, 'last_name': 'Admin'}], 'schema': 'public', 'sql': "SELECT analysis_month, category, SUM(volume) as total_volume             FROM proc_esg_monthly_summary             WHERE analysis_month IN ('2024-03', '2024-04') AND category IN ('Environmental', 'Social', 'Governance')             GROUP BY analysis_month, category             ORDER BY analysis_month, category;", 'table_name': '2024년 3월과 4월 EGS 데이터 분석: 환경, 사회, 거버넌스 항목의 바차트 시각화'}]}
INFO:     127.0.0.1:53270 - "POST /process_state/ HTTP/1.1" 200 OK
[{'role': 'system', 'content': 'the final answer to the original input question (If the user asks a question in Korean, the answer must be answered in Korean, if the user asks a question in English, the answer must be answered in English, and if the user asks a question in Japanese, the answer must be answered in Japanese.)The user provides a question and you provide SQL. You will only respond with SQL code and not with any explanations.\n\nRespond with only SQL code. Do not answer with any explanations -- just the code.\n\nYou may use the following documentation as a reference for what tables might be available. Use responses to past questions also to guide you:\n\nThe following columns are in the esg_monthly_change_analysis table in the superset database:\n\n|     | table_catalog   | table_schema   | table_name                  | column_name       | data_type   |\n|----:|:----------------|:---------------|:----------------------------|:------------------|:------------|\n| 434 | superset        | public         | esg_monthly_change_analysis | current_value     | numeric     |\n| 435 | superset        | public         | esg_monthly_change_analysis | previous_value    | numeric     |\n| 436 | superset        | public         | esg_monthly_change_analysis | change_value      | numeric     |\n| 437 | superset        | public         | esg_monthly_change_analysis | change_percentage | numeric     |\n| 509 | superset        | public         | esg_monthly_change_analysis | current_month     | text        |\n| 520 | superset        | public         | esg_monthly_change_analysis | previous_month    | text        |\n| 543 | superset        | public         | esg_monthly_change_analysis | category          | text        |\n\nThe following columns are in the proc_esg_monthly_summary table in the superset database:\n\n|     | table_catalog   | table_schema   | table_name               | column_name    | data_type   |\n|----:|:----------------|:---------------|:-------------------------|:---------------|:------------|\n| 179 | superset        | public         | proc_esg_monthly_summary | cluster_size   | bigint      |\n| 180 | superset        | public         | proc_esg_monthly_summary | probability    | bigint      |\n| 181 | superset        | public         | proc_esg_monthly_summary | volume         | numeric     |\n| 548 | superset        | public         | proc_esg_monthly_summary | analysis_month | text        |\n| 549 | superset        | public         | proc_esg_monthly_summary | category       | text        |\n| 550 | superset        | public         | proc_esg_monthly_summary | summary        | text        |\n\nThe following columns are in the raw_esg_volume_positive table in the superset database:\n\n|     | table_catalog   | table_schema   | table_name              | column_name                     | data_type   |\n|----:|:----------------|:---------------|:------------------------|:--------------------------------|:------------|\n| 311 | superset        | public         | raw_esg_volume_positive | period                          | date        |\n| 312 | superset        | public         | raw_esg_volume_positive | total                           | bigint      |\n| 313 | superset        | public         | raw_esg_volume_positive | online_news                     | bigint      |\n| 314 | superset        | public         | raw_esg_volume_positive | sov                             | bigint      |\n| 315 | superset        | public         | raw_esg_volume_positive | environmental                   | bigint      |\n| 316 | superset        | public         | raw_esg_volume_positive | social                          | bigint      |\n| 317 | superset        | public         | raw_esg_volume_positive | governance                      | bigint      |\n| 318 | superset        | public         | raw_esg_volume_positive | tech                            | bigint      |\n| 319 | superset        | public         | raw_esg_volume_positive | financial_service               | bigint      |\n| 320 | superset        | public         | raw_esg_volume_positive | hardware                        | bigint      |\n| 321 | superset        | public         | raw_esg_volume_positive | energy                          | bigint      |\n| 322 | superset        | public         | raw_esg_volume_positive | biotech                         | bigint      |\n| 323 | superset        | public         | raw_esg_volume_positive | retail                          | bigint      |\n| 324 | superset        | public         | raw_esg_volume_positive | electricity                     | bigint      |\n| 325 | superset        | public         | raw_esg_volume_positive | food                            | bigint      |\n| 326 | superset        | public         | raw_esg_volume_positive | automakers                      | bigint      |\n| 327 | superset        | public         | raw_esg_volume_positive | telecommunication               | bigint      |\n| 328 | superset        | public         | raw_esg_volume_positive | beauty_fashion                  | bigint      |\n| 329 | superset        | public         | raw_esg_volume_positive | sda                             | bigint      |\n| 330 | superset        | public         | raw_esg_volume_positive | dutyfree                        | bigint      |\n| 331 | superset        | public         | raw_esg_volume_positive | hotel_resort                    | bigint      |\n| 332 | superset        | public         | raw_esg_volume_positive | apple                           | bigint      |\n| 333 | superset        | public         | raw_esg_volume_positive | nvidia                          | bigint      |\n| 334 | superset        | public         | raw_esg_volume_positive | amazon                          | bigint      |\n| 335 | superset        | public         | raw_esg_volume_positive | google                          | bigint      |\n| 336 | superset        | public         | raw_esg_volume_positive | meta                            | bigint      |\n| 337 | superset        | public         | raw_esg_volume_positive | tesla                           | bigint      |\n| 338 | superset        | public         | raw_esg_volume_positive | visa                            | bigint      |\n| 339 | superset        | public         | raw_esg_volume_positive | jpm                             | bigint      |\n| 340 | superset        | public         | raw_esg_volume_positive | mastercard                      | bigint      |\n| 341 | superset        | public         | raw_esg_volume_positive | tsmc                            | bigint      |\n| 342 | superset        | public         | raw_esg_volume_positive | samsung                         | bigint      |\n| 343 | superset        | public         | raw_esg_volume_positive | elilily                         | bigint      |\n| 344 | superset        | public         | raw_esg_volume_positive | novo                            | bigint      |\n| 345 | superset        | public         | raw_esg_volume_positive | jnj                             | bigint      |\n| 346 | superset        | public         | raw_esg_volume_positive | aramco                          | bigint      |\n| 347 | superset        | public         | raw_esg_volume_positive | exxon                           | bigint      |\n| 348 | superset        | public         | raw_esg_volume_positive | chevron                         | bigint      |\n| 349 | superset        | public         | raw_esg_volume_positive | ms                              | bigint      |\n| 350 | superset        | public         | raw_esg_volume_positive | toyota                          | bigint      |\n| 351 | superset        | public         | raw_esg_volume_positive | materials                       | bigint      |\n| 352 | superset        | public         | raw_esg_volume_positive | energy_kr                       | bigint      |\n| 353 | superset        | public         | raw_esg_volume_positive | water_and_effluents             | bigint      |\n| 354 | superset        | public         | raw_esg_volume_positive | biodiversity                    | bigint      |\n| 355 | superset        | public         | raw_esg_volume_positive | emissions                       | bigint      |\n| 356 | superset        | public         | raw_esg_volume_positive | waste                           | bigint      |\n| 357 | superset        | public         | raw_esg_volume_positive | employment                      | bigint      |\n| 358 | superset        | public         | raw_esg_volume_positive | labor_management_relations      | bigint      |\n| 359 | superset        | public         | raw_esg_volume_positive | occupational_health_and_safety  | bigint      |\n| 360 | superset        | public         | raw_esg_volume_positive | training_and_education          | bigint      |\n| 361 | superset        | public         | raw_esg_volume_positive | diversity_and_equal_opportunity | bigint      |\n| 362 | superset        | public         | raw_esg_volume_positive | child_labor                     | bigint      |\n| 363 | superset        | public         | raw_esg_volume_positive | local_communities               | bigint      |\n| 364 | superset        | public         | raw_esg_volume_positive | supplier_social_assessment      | bigint      |\n| 365 | superset        | public         | raw_esg_volume_positive | customer_health_and_safety      | bigint      |\n| 366 | superset        | public         | raw_esg_volume_positive | customer_privacy                | bigint      |\n| 367 | superset        | public         | raw_esg_volume_positive | anti_corruption                 | bigint      |\n| 368 | superset        | public         | raw_esg_volume_positive | anti_competitive_behavior       | bigint      |\n| 369 | superset        | public         | raw_esg_volume_positive | board_of_directors_composition  | bigint      |\n| 370 | superset        | public         | raw_esg_volume_positive | e_apple                         | bigint      |\n| 371 | superset        | public         | raw_esg_volume_positive | e_nvidia                        | bigint      |\n| 372 | superset        | public         | raw_esg_volume_positive | e_amazon                        | bigint      |\n| 373 | superset        | public         | raw_esg_volume_positive | e_google                        | bigint      |\n| 374 | superset        | public         | raw_esg_volume_positive | e_meta                          | bigint      |\n| 375 | superset        | public         | raw_esg_volume_positive | e_tesla                         | bigint      |\n| 376 | superset        | public         | raw_esg_volume_positive | e_visa                          | bigint      |\n| 377 | superset        | public         | raw_esg_volume_positive | e_jpm                           | bigint      |\n| 378 | superset        | public         | raw_esg_volume_positive | e_mastercard                    | bigint      |\n| 379 | superset        | public         | raw_esg_volume_positive | e_tsmc                          | bigint      |\n| 380 | superset        | public         | raw_esg_volume_positive | e_samsung                       | bigint      |\n| 381 | superset        | public         | raw_esg_volume_positive | e_elilily                       | bigint      |\n| 382 | superset        | public         | raw_esg_volume_positive | e_novo                          | bigint      |\n| 383 | superset        | public         | raw_esg_volume_positive | e_jnj                           | bigint      |\n| 384 | superset        | public         | raw_esg_volume_positive | e_aramco                        | bigint      |\n| 385 | superset        | public         | raw_esg_volume_positive | e_exxon                         | bigint      |\n| 386 | superset        | public         | raw_esg_volume_positive | e_chevron                       | bigint      |\n| 387 | superset        | public         | raw_esg_volume_positive | e_ms                            | bigint      |\n| 388 | superset        | public         | raw_esg_volume_positive | e_toyota                        | bigint      |\n| 389 | superset        | public         | raw_esg_volume_positive | s_apple                         | bigint      |\n| 390 | superset        | public         | raw_esg_volume_positive | s_nvidia                        | bigint      |\n| 391 | superset        | public         | raw_esg_volume_positive | s_amazon                        | bigint      |\n| 392 | superset        | public         | raw_esg_volume_positive | s_google                        | bigint      |\n| 393 | superset        | public         | raw_esg_volume_positive | s_meta                          | bigint      |\n| 394 | superset        | public         | raw_esg_volume_positive | s_tesla                         | bigint      |\n| 395 | superset        | public         | raw_esg_volume_positive | s_visa                          | bigint      |\n| 396 | superset        | public         | raw_esg_volume_positive | s_jpm                           | bigint      |\n| 397 | superset        | public         | raw_esg_volume_positive | s_mastercard                    | bigint      |\n| 398 | superset        | public         | raw_esg_volume_positive | s_tsmc                          | bigint      |\n| 399 | superset        | public         | raw_esg_volume_positive | s_samsung                       | bigint      |\n| 400 | superset        | public         | raw_esg_volume_positive | s_elilily                       | bigint      |\n| 401 | superset        | public         | raw_esg_volume_positive | s_novo                          | bigint      |\n| 402 | superset        | public         | raw_esg_volume_positive | s_jnj                           | bigint      |\n| 403 | superset        | public         | raw_esg_volume_positive | s_aramco                        | bigint      |\n| 404 | superset        | public         | raw_esg_volume_positive | s_exxon                         | bigint      |\n| 405 | superset        | public         | raw_esg_volume_positive | s_chevron                       | bigint      |\n| 406 | superset        | public         | raw_esg_volume_positive | s_ms                            | bigint      |\n| 407 | superset        | public         | raw_esg_volume_positive | s_toyota                        | bigint      |\n| 408 | superset        | public         | raw_esg_volume_positive | g_apple                         | bigint      |\n| 409 | superset        | public         | raw_esg_volume_positive | g_nvidia                        | bigint      |\n| 410 | superset        | public         | raw_esg_volume_positive | g_amazon                        | bigint      |\n| 411 | superset        | public         | raw_esg_volume_positive | g_google                        | bigint      |\n| 412 | superset        | public         | raw_esg_volume_positive | g_meta                          | bigint      |\n| 413 | superset        | public         | raw_esg_volume_positive | g_tesla                         | bigint      |\n| 414 | superset        | public         | raw_esg_volume_positive | g_visa                          | bigint      |\n| 415 | superset        | public         | raw_esg_volume_positive | g_jpm                           | bigint      |\n| 416 | superset        | public         | raw_esg_volume_positive | g_mastercard                    | bigint      |\n| 417 | superset        | public         | raw_esg_volume_positive | g_tsmc                          | bigint      |\n| 418 | superset        | public         | raw_esg_volume_positive | g_samsung                       | bigint      |\n| 419 | superset        | public         | raw_esg_volume_positive | g_elilily                       | bigint      |\n| 420 | superset        | public         | raw_esg_volume_positive | g_novo                          | bigint      |\n| 421 | superset        | public         | raw_esg_volume_positive | g_jnj                           | bigint      |\n| 422 | superset        | public         | raw_esg_volume_positive | g_aramco                        | bigint      |\n| 423 | superset        | public         | raw_esg_volume_positive | g_exxon                         | bigint      |\n| 424 | superset        | public         | raw_esg_volume_positive | g_chevron                       | bigint      |\n| 425 | superset        | public         | raw_esg_volume_positive | g_ms                            | bigint      |\n| 426 | superset        | public         | raw_esg_volume_positive | g_toyota                        | bigint      |\n| 427 | superset        | public         | raw_esg_volume_positive | analysis_week                   | bigint      |\n| 538 | superset        | public         | raw_esg_volume_positive | analysis_month                  | text        |\n\nThe following columns are in the esg_weekly_change_analysis table in the superset database:\n\n|     | table_catalog   | table_schema   | table_name                 | column_name       | data_type   |\n|----:|:----------------|:---------------|:---------------------------|:------------------|:------------|\n| 428 | superset        | public         | esg_weekly_change_analysis | current_week      | bigint      |\n| 429 | superset        | public         | esg_weekly_change_analysis | current_value     | numeric     |\n| 430 | superset        | public         | esg_weekly_change_analysis | previous_week     | bigint      |\n| 431 | superset        | public         | esg_weekly_change_analysis | previous_value    | numeric     |\n| 432 | superset        | public         | esg_weekly_change_analysis | change_value      | numeric     |\n| 433 | superset        | public         | esg_weekly_change_analysis | change_percentage | numeric     |\n| 533 | superset        | public         | esg_weekly_change_analysis | category          | text        |\n\nThe following columns are in the raw_esg_volume table in the superset database:\n\n|     | table_catalog   | table_schema   | table_name     | column_name                     | data_type   |\n|----:|:----------------|:---------------|:---------------|:--------------------------------|:------------|\n| 186 | superset        | public         | raw_esg_volume | period                          | date        |\n| 187 | superset        | public         | raw_esg_volume | total                           | bigint      |\n| 188 | superset        | public         | raw_esg_volume | online_news                     | bigint      |\n| 189 | superset        | public         | raw_esg_volume | sov                             | bigint      |\n| 190 | superset        | public         | raw_esg_volume | environmental                   | bigint      |\n| 191 | superset        | public         | raw_esg_volume | social                          | bigint      |\n| 192 | superset        | public         | raw_esg_volume | governance                      | bigint      |\n| 193 | superset        | public         | raw_esg_volume | tech                            | bigint      |\n| 194 | superset        | public         | raw_esg_volume | financial_service               | bigint      |\n| 195 | superset        | public         | raw_esg_volume | hardware                        | bigint      |\n| 196 | superset        | public         | raw_esg_volume | energy                          | bigint      |\n| 197 | superset        | public         | raw_esg_volume | biotech                         | bigint      |\n| 198 | superset        | public         | raw_esg_volume | retail                          | bigint      |\n| 199 | superset        | public         | raw_esg_volume | electricity                     | bigint      |\n| 200 | superset        | public         | raw_esg_volume | food                            | bigint      |\n| 201 | superset        | public         | raw_esg_volume | automakers                      | bigint      |\n| 202 | superset        | public         | raw_esg_volume | telecommunication               | bigint      |\n| 203 | superset        | public         | raw_esg_volume | beauty_fashion                  | bigint      |\n| 204 | superset        | public         | raw_esg_volume | sda                             | bigint      |\n| 205 | superset        | public         | raw_esg_volume | dutyfree                        | bigint      |\n| 206 | superset        | public         | raw_esg_volume | hotel_resort                    | bigint      |\n| 207 | superset        | public         | raw_esg_volume | apple                           | bigint      |\n| 208 | superset        | public         | raw_esg_volume | nvidia                          | bigint      |\n| 209 | superset        | public         | raw_esg_volume | amazon                          | bigint      |\n| 210 | superset        | public         | raw_esg_volume | google                          | bigint      |\n| 211 | superset        | public         | raw_esg_volume | meta                            | bigint      |\n| 212 | superset        | public         | raw_esg_volume | tesla                           | bigint      |\n| 213 | superset        | public         | raw_esg_volume | visa                            | bigint      |\n| 214 | superset        | public         | raw_esg_volume | jpm                             | bigint      |\n| 215 | superset        | public         | raw_esg_volume | mastercard                      | bigint      |\n| 216 | superset        | public         | raw_esg_volume | tsmc                            | bigint      |\n| 217 | superset        | public         | raw_esg_volume | samsung                         | bigint      |\n| 218 | superset        | public         | raw_esg_volume | elilily                         | bigint      |\n| 219 | superset        | public         | raw_esg_volume | novo                            | bigint      |\n| 220 | superset        | public         | raw_esg_volume | jnj                             | bigint      |\n| 221 | superset        | public         | raw_esg_volume | aramco                          | bigint      |\n| 222 | superset        | public         | raw_esg_volume | exxon                           | bigint      |\n| 223 | superset        | public         | raw_esg_volume | chevron                         | bigint      |\n| 224 | superset        | public         | raw_esg_volume | ms                              | bigint      |\n| 225 | superset        | public         | raw_esg_volume | toyota                          | bigint      |\n| 226 | superset        | public         | raw_esg_volume | materials                       | bigint      |\n| 227 | superset        | public         | raw_esg_volume | energy_kr                       | bigint      |\n| 228 | superset        | public         | raw_esg_volume | water_and_effluents             | bigint      |\n| 229 | superset        | public         | raw_esg_volume | biodiversity                    | bigint      |\n| 230 | superset        | public         | raw_esg_volume | emissions                       | bigint      |\n| 231 | superset        | public         | raw_esg_volume | waste                           | bigint      |\n| 232 | superset        | public         | raw_esg_volume | employment                      | bigint      |\n| 233 | superset        | public         | raw_esg_volume | labor_management_relations      | bigint      |\n| 234 | superset        | public         | raw_esg_volume | occupational_health_and_safety  | bigint      |\n| 235 | superset        | public         | raw_esg_volume | training_and_education          | bigint      |\n| 236 | superset        | public         | raw_esg_volume | diversity_and_equal_opportunity | bigint      |\n| 237 | superset        | public         | raw_esg_volume | child_labor                     | bigint      |\n| 238 | superset        | public         | raw_esg_volume | local_communities               | bigint      |\n| 239 | superset        | public         | raw_esg_volume | supplier_social_assessment      | bigint      |\n| 240 | superset        | public         | raw_esg_volume | customer_health_and_safety      | bigint      |\n| 241 | superset        | public         | raw_esg_volume | customer_privacy                | bigint      |\n| 242 | superset        | public         | raw_esg_volume | anti_corruption                 | bigint      |\n| 243 | superset        | public         | raw_esg_volume | anti_competitive_behavior       | bigint      |\n| 244 | superset        | public         | raw_esg_volume | board_of_directors_composition  | bigint      |\n| 245 | superset        | public         | raw_esg_volume | e_apple                         | bigint      |\n| 246 | superset        | public         | raw_esg_volume | e_nvidia                        | bigint      |\n| 247 | superset        | public         | raw_esg_volume | e_amazon                        | bigint      |\n| 248 | superset        | public         | raw_esg_volume | e_google                        | bigint      |\n| 249 | superset        | public         | raw_esg_volume | e_meta                          | bigint      |\n| 250 | superset        | public         | raw_esg_volume | e_tesla                         | bigint      |\n| 251 | superset        | public         | raw_esg_volume | e_visa                          | bigint      |\n| 252 | superset        | public         | raw_esg_volume | e_jpm                           | bigint      |\n| 253 | superset        | public         | raw_esg_volume | e_mastercard                    | bigint      |\n| 254 | superset        | public         | raw_esg_volume | e_tsmc                          | bigint      |\n| 255 | superset        | public         | raw_esg_volume | e_samsung                       | bigint      |\n| 256 | superset        | public         | raw_esg_volume | e_elilily                       | bigint      |\n| 257 | superset        | public         | raw_esg_volume | e_novo                          | bigint      |\n| 258 | superset        | public         | raw_esg_volume | e_jnj                           | bigint      |\n| 259 | superset        | public         | raw_esg_volume | e_aramco                        | bigint      |\n| 260 | superset        | public         | raw_esg_volume | e_exxon                         | bigint      |\n| 261 | superset        | public         | raw_esg_volume | e_chevron                       | bigint      |\n| 262 | superset        | public         | raw_esg_volume | e_ms                            | bigint      |\n| 263 | superset        | public         | raw_esg_volume | e_toyota                        | bigint      |\n| 264 | superset        | public         | raw_esg_volume | s_apple                         | bigint      |\n| 265 | superset        | public         | raw_esg_volume | s_nvidia                        | bigint      |\n| 266 | superset        | public         | raw_esg_volume | s_amazon                        | bigint      |\n| 267 | superset        | public         | raw_esg_volume | s_google                        | bigint      |\n| 268 | superset        | public         | raw_esg_volume | s_meta                          | bigint      |\n| 269 | superset        | public         | raw_esg_volume | s_tesla                         | bigint      |\n| 270 | superset        | public         | raw_esg_volume | s_visa                          | bigint      |\n| 271 | superset        | public         | raw_esg_volume | s_jpm                           | bigint      |\n| 272 | superset        | public         | raw_esg_volume | s_mastercard                    | bigint      |\n| 273 | superset        | public         | raw_esg_volume | s_tsmc                          | bigint      |\n| 274 | superset        | public         | raw_esg_volume | s_samsung                       | bigint      |\n| 275 | superset        | public         | raw_esg_volume | s_elilily                       | bigint      |\n| 276 | superset        | public         | raw_esg_volume | s_novo                          | bigint      |\n| 277 | superset        | public         | raw_esg_volume | s_jnj                           | bigint      |\n| 278 | superset        | public         | raw_esg_volume | s_aramco                        | bigint      |\n| 279 | superset        | public         | raw_esg_volume | s_exxon                         | bigint      |\n| 280 | superset        | public         | raw_esg_volume | s_chevron                       | bigint      |\n| 281 | superset        | public         | raw_esg_volume | s_ms                            | bigint      |\n| 282 | superset        | public         | raw_esg_volume | s_toyota                        | bigint      |\n| 283 | superset        | public         | raw_esg_volume | g_apple                         | bigint      |\n| 284 | superset        | public         | raw_esg_volume | g_nvidia                        | bigint      |\n| 285 | superset        | public         | raw_esg_volume | g_amazon                        | bigint      |\n| 286 | superset        | public         | raw_esg_volume | g_google                        | bigint      |\n| 287 | superset        | public         | raw_esg_volume | g_meta                          | bigint      |\n| 288 | superset        | public         | raw_esg_volume | g_tesla                         | bigint      |\n| 289 | superset        | public         | raw_esg_volume | g_visa                          | bigint      |\n| 290 | superset        | public         | raw_esg_volume | g_jpm                           | bigint      |\n| 291 | superset        | public         | raw_esg_volume | g_mastercard                    | bigint      |\n| 292 | superset        | public         | raw_esg_volume | g_tsmc                          | bigint      |\n| 293 | superset        | public         | raw_esg_volume | g_samsung                       | bigint      |\n| 294 | superset        | public         | raw_esg_volume | g_elilily                       | bigint      |\n| 295 | superset        | public         | raw_esg_volume | g_novo                          | bigint      |\n| 296 | superset        | public         | raw_esg_volume | g_jnj                           | bigint      |\n| 297 | superset        | public         | raw_esg_volume | g_aramco                        | bigint      |\n| 298 | superset        | public         | raw_esg_volume | g_exxon                         | bigint      |\n| 299 | superset        | public         | raw_esg_volume | g_chevron                       | bigint      |\n| 300 | superset        | public         | raw_esg_volume | g_ms                            | bigint      |\n| 301 | superset        | public         | raw_esg_volume | g_toyota                        | bigint      |\n| 302 | superset        | public         | raw_esg_volume | analysis_week                   | bigint      |\n| 541 | superset        | public         | raw_esg_volume | analysis_month                  | text        |\n\nThe following columns are in the raw_esg_volume_pos_neg_diff table in the superset database:\n\n|     | table_catalog   | table_schema   | table_name                  | column_name                     | data_type   |\n|----:|:----------------|:---------------|:----------------------------|:--------------------------------|:------------|\n|  56 | superset        | public         | raw_esg_volume_pos_neg_diff | period                          | date        |\n|  57 | superset        | public         | raw_esg_volume_pos_neg_diff | total                           | bigint      |\n|  58 | superset        | public         | raw_esg_volume_pos_neg_diff | online_news                     | bigint      |\n|  59 | superset        | public         | raw_esg_volume_pos_neg_diff | sov                             | bigint      |\n|  60 | superset        | public         | raw_esg_volume_pos_neg_diff | environmental                   | bigint      |\n|  61 | superset        | public         | raw_esg_volume_pos_neg_diff | social                          | bigint      |\n|  62 | superset        | public         | raw_esg_volume_pos_neg_diff | governance                      | bigint      |\n|  63 | superset        | public         | raw_esg_volume_pos_neg_diff | tech                            | bigint      |\n|  64 | superset        | public         | raw_esg_volume_pos_neg_diff | financial_service               | bigint      |\n|  65 | superset        | public         | raw_esg_volume_pos_neg_diff | hardware                        | bigint      |\n|  66 | superset        | public         | raw_esg_volume_pos_neg_diff | energy                          | bigint      |\n|  67 | superset        | public         | raw_esg_volume_pos_neg_diff | biotech                         | bigint      |\n|  68 | superset        | public         | raw_esg_volume_pos_neg_diff | retail                          | bigint      |\n|  69 | superset        | public         | raw_esg_volume_pos_neg_diff | electricity                     | bigint      |\n|  70 | superset        | public         | raw_esg_volume_pos_neg_diff | food                            | bigint      |\n|  71 | superset        | public         | raw_esg_volume_pos_neg_diff | automakers                      | bigint      |\n|  72 | superset        | public         | raw_esg_volume_pos_neg_diff | telecommunication               | bigint      |\n|  73 | superset        | public         | raw_esg_volume_pos_neg_diff | beauty_fashion                  | bigint      |\n|  74 | superset        | public         | raw_esg_volume_pos_neg_diff | sda                             | bigint      |\n|  75 | superset        | public         | raw_esg_volume_pos_neg_diff | dutyfree                        | bigint      |\n|  76 | superset        | public         | raw_esg_volume_pos_neg_diff | hotel_resort                    | bigint      |\n|  77 | superset        | public         | raw_esg_volume_pos_neg_diff | apple                           | bigint      |\n|  78 | superset        | public         | raw_esg_volume_pos_neg_diff | nvidia                          | bigint      |\n|  79 | superset        | public         | raw_esg_volume_pos_neg_diff | amazon                          | bigint      |\n|  80 | superset        | public         | raw_esg_volume_pos_neg_diff | google                          | bigint      |\n|  81 | superset        | public         | raw_esg_volume_pos_neg_diff | meta                            | bigint      |\n|  82 | superset        | public         | raw_esg_volume_pos_neg_diff | tesla                           | bigint      |\n|  83 | superset        | public         | raw_esg_volume_pos_neg_diff | visa                            | bigint      |\n|  84 | superset        | public         | raw_esg_volume_pos_neg_diff | jpm                             | bigint      |\n|  85 | superset        | public         | raw_esg_volume_pos_neg_diff | mastercard                      | bigint      |\n|  86 | superset        | public         | raw_esg_volume_pos_neg_diff | tsmc                            | bigint      |\n|  87 | superset        | public         | raw_esg_volume_pos_neg_diff | samsung                         | bigint      |\n|  88 | superset        | public         | raw_esg_volume_pos_neg_diff | elilily                         | bigint      |\n|  89 | superset        | public         | raw_esg_volume_pos_neg_diff | novo                            | bigint      |\n|  90 | superset        | public         | raw_esg_volume_pos_neg_diff | jnj                             | bigint      |\n|  91 | superset        | public         | raw_esg_volume_pos_neg_diff | aramco                          | bigint      |\n|  92 | superset        | public         | raw_esg_volume_pos_neg_diff | exxon                           | bigint      |\n|  93 | superset        | public         | raw_esg_volume_pos_neg_diff | chevron                         | bigint      |\n|  94 | superset        | public         | raw_esg_volume_pos_neg_diff | ms                              | bigint      |\n|  95 | superset        | public         | raw_esg_volume_pos_neg_diff | toyota                          | bigint      |\n|  96 | superset        | public         | raw_esg_volume_pos_neg_diff | materials                       | bigint      |\n|  97 | superset        | public         | raw_esg_volume_pos_neg_diff | energy_kr                       | bigint      |\n|  98 | superset        | public         | raw_esg_volume_pos_neg_diff | water_and_effluents             | bigint      |\n|  99 | superset        | public         | raw_esg_volume_pos_neg_diff | biodiversity                    | bigint      |\n| 100 | superset        | public         | raw_esg_volume_pos_neg_diff | emissions                       | bigint      |\n| 101 | superset        | public         | raw_esg_volume_pos_neg_diff | waste                           | bigint      |\n| 102 | superset        | public         | raw_esg_volume_pos_neg_diff | employment                      | bigint      |\n| 103 | superset        | public         | raw_esg_volume_pos_neg_diff | labor_management_relations      | bigint      |\n| 104 | superset        | public         | raw_esg_volume_pos_neg_diff | occupational_health_and_safety  | bigint      |\n| 105 | superset        | public         | raw_esg_volume_pos_neg_diff | training_and_education          | bigint      |\n| 106 | superset        | public         | raw_esg_volume_pos_neg_diff | diversity_and_equal_opportunity | bigint      |\n| 107 | superset        | public         | raw_esg_volume_pos_neg_diff | child_labor                     | bigint      |\n| 108 | superset        | public         | raw_esg_volume_pos_neg_diff | local_communities               | bigint      |\n| 109 | superset        | public         | raw_esg_volume_pos_neg_diff | supplier_social_assessment      | bigint      |\n| 110 | superset        | public         | raw_esg_volume_pos_neg_diff | customer_health_and_safety      | bigint      |\n| 111 | superset        | public         | raw_esg_volume_pos_neg_diff | customer_privacy                | bigint      |\n| 112 | superset        | public         | raw_esg_volume_pos_neg_diff | anti_corruption                 | bigint      |\n| 113 | superset        | public         | raw_esg_volume_pos_neg_diff | anti_competitive_behavior       | bigint      |\n| 114 | superset        | public         | raw_esg_volume_pos_neg_diff | board_of_directors_composition  | bigint      |\n| 115 | superset        | public         | raw_esg_volume_pos_neg_diff | e_apple                         | bigint      |\n| 116 | superset        | public         | raw_esg_volume_pos_neg_diff | e_nvidia                        | bigint      |\n| 117 | superset        | public         | raw_esg_volume_pos_neg_diff | e_amazon                        | bigint      |\n| 118 | superset        | public         | raw_esg_volume_pos_neg_diff | e_google                        | bigint      |\n| 119 | superset        | public         | raw_esg_volume_pos_neg_diff | e_meta                          | bigint      |\n| 120 | superset        | public         | raw_esg_volume_pos_neg_diff | e_tesla                         | bigint      |\n| 121 | superset        | public         | raw_esg_volume_pos_neg_diff | e_visa                          | bigint      |\n| 122 | superset        | public         | raw_esg_volume_pos_neg_diff | e_jpm                           | bigint      |\n| 123 | superset        | public         | raw_esg_volume_pos_neg_diff | e_mastercard                    | bigint      |\n| 124 | superset        | public         | raw_esg_volume_pos_neg_diff | e_tsmc                          | bigint      |\n| 125 | superset        | public         | raw_esg_volume_pos_neg_diff | e_samsung                       | bigint      |\n| 126 | superset        | public         | raw_esg_volume_pos_neg_diff | e_elilily                       | bigint      |\n| 127 | superset        | public         | raw_esg_volume_pos_neg_diff | e_novo                          | bigint      |\n| 128 | superset        | public         | raw_esg_volume_pos_neg_diff | e_jnj                           | bigint      |\n| 129 | superset        | public         | raw_esg_volume_pos_neg_diff | e_aramco                        | bigint      |\n| 130 | superset        | public         | raw_esg_volume_pos_neg_diff | e_exxon                         | bigint      |\n| 131 | superset        | public         | raw_esg_volume_pos_neg_diff | e_chevron                       | bigint      |\n| 132 | superset        | public         | raw_esg_volume_pos_neg_diff | e_ms                            | bigint      |\n| 133 | superset        | public         | raw_esg_volume_pos_neg_diff | e_toyota                        | bigint      |\n| 134 | superset        | public         | raw_esg_volume_pos_neg_diff | s_apple                         | bigint      |\n| 135 | superset        | public         | raw_esg_volume_pos_neg_diff | s_nvidia                        | bigint      |\n| 136 | superset        | public         | raw_esg_volume_pos_neg_diff | s_amazon                        | bigint      |\n| 137 | superset        | public         | raw_esg_volume_pos_neg_diff | s_google                        | bigint      |\n| 138 | superset        | public         | raw_esg_volume_pos_neg_diff | s_meta                          | bigint      |\n| 139 | superset        | public         | raw_esg_volume_pos_neg_diff | s_tesla                         | bigint      |\n| 140 | superset        | public         | raw_esg_volume_pos_neg_diff | s_visa                          | bigint      |\n| 141 | superset        | public         | raw_esg_volume_pos_neg_diff | s_jpm                           | bigint      |\n| 142 | superset        | public         | raw_esg_volume_pos_neg_diff | s_mastercard                    | bigint      |\n| 143 | superset        | public         | raw_esg_volume_pos_neg_diff | s_tsmc                          | bigint      |\n| 144 | superset        | public         | raw_esg_volume_pos_neg_diff | s_samsung                       | bigint      |\n| 145 | superset        | public         | raw_esg_volume_pos_neg_diff | s_elilily                       | bigint      |\n| 146 | superset        | public         | raw_esg_volume_pos_neg_diff | s_novo                          | bigint      |\n| 147 | superset        | public         | raw_esg_volume_pos_neg_diff | s_jnj                           | bigint      |\n| 148 | superset        | public         | raw_esg_volume_pos_neg_diff | s_aramco                        | bigint      |\n| 149 | superset        | public         | raw_esg_volume_pos_neg_diff | s_exxon                         | bigint      |\n| 150 | superset        | public         | raw_esg_volume_pos_neg_diff | s_chevron                       | bigint      |\n| 151 | superset        | public         | raw_esg_volume_pos_neg_diff | s_ms                            | bigint      |\n| 152 | superset        | public         | raw_esg_volume_pos_neg_diff | s_toyota                        | bigint      |\n| 153 | superset        | public         | raw_esg_volume_pos_neg_diff | g_apple                         | bigint      |\n| 154 | superset        | public         | raw_esg_volume_pos_neg_diff | g_nvidia                        | bigint      |\n| 155 | superset        | public         | raw_esg_volume_pos_neg_diff | g_amazon                        | bigint      |\n| 156 | superset        | public         | raw_esg_volume_pos_neg_diff | g_google                        | bigint      |\n| 157 | superset        | public         | raw_esg_volume_pos_neg_diff | g_meta                          | bigint      |\n| 158 | superset        | public         | raw_esg_volume_pos_neg_diff | g_tesla                         | bigint      |\n| 159 | superset        | public         | raw_esg_volume_pos_neg_diff | g_visa                          | bigint      |\n| 160 | superset        | public         | raw_esg_volume_pos_neg_diff | g_jpm                           | bigint      |\n| 161 | superset        | public         | raw_esg_volume_pos_neg_diff | g_mastercard                    | bigint      |\n| 162 | superset        | public         | raw_esg_volume_pos_neg_diff | g_tsmc                          | bigint      |\n| 163 | superset        | public         | raw_esg_volume_pos_neg_diff | g_samsung                       | bigint      |\n| 164 | superset        | public         | raw_esg_volume_pos_neg_diff | g_elilily                       | bigint      |\n| 165 | superset        | public         | raw_esg_volume_pos_neg_diff | g_novo                          | bigint      |\n| 166 | superset        | public         | raw_esg_volume_pos_neg_diff | g_jnj                           | bigint      |\n| 167 | superset        | public         | raw_esg_volume_pos_neg_diff | g_aramco                        | bigint      |\n| 168 | superset        | public         | raw_esg_volume_pos_neg_diff | g_exxon                         | bigint      |\n| 169 | superset        | public         | raw_esg_volume_pos_neg_diff | g_chevron                       | bigint      |\n| 170 | superset        | public         | raw_esg_volume_pos_neg_diff | g_ms                            | bigint      |\n| 171 | superset        | public         | raw_esg_volume_pos_neg_diff | g_toyota                        | bigint      |\n| 172 | superset        | public         | raw_esg_volume_pos_neg_diff | analysis_week                   | bigint      |\n| 527 | superset        | public         | raw_esg_volume_pos_neg_diff | analysis_month                  | text        |\n\nThe following columns are in the proc_esg_weekly_summary table in the superset database:\n\n|     | table_catalog   | table_schema   | table_name              | column_name    | data_type   |\n|----:|:----------------|:---------------|:------------------------|:---------------|:------------|\n| 182 | superset        | public         | proc_esg_weekly_summary | analysis_week  | bigint      |\n| 183 | superset        | public         | proc_esg_weekly_summary | cluster_size   | bigint      |\n| 184 | superset        | public         | proc_esg_weekly_summary | probability    | bigint      |\n| 185 | superset        | public         | proc_esg_weekly_summary | volume         | numeric     |\n| 532 | superset        | public         | proc_esg_weekly_summary | analysis_month | text        |\n| 534 | superset        | public         | proc_esg_weekly_summary | category       | text        |\n| 535 | superset        | public         | proc_esg_weekly_summary | summary        | text        |\n\nThe following columns are in the esg_industry_view table in the superset database:\n\n|     | table_catalog   | table_schema   | table_name        | column_name    | data_type   |\n|----:|:----------------|:---------------|:------------------|:---------------|:------------|\n| 308 | superset        | public         | esg_industry_view | analysis_week  | bigint      |\n| 309 | superset        | public         | esg_industry_view | period         | date        |\n| 310 | superset        | public         | esg_industry_view | value          | bigint      |\n| 522 | superset        | public         | esg_industry_view | analysis_month | text        |\n| 528 | superset        | public         | esg_industry_view | category       | text        |\n| 537 | superset        | public         | esg_industry_view | column         | text        |\n\nThe following columns are in the raw_esg_cluster table in the superset database:\n\n|     | table_catalog   | table_schema   | table_name      | column_name      | data_type   |\n|----:|:----------------|:---------------|:----------------|:-----------------|:------------|\n|   1 | superset        | public         | raw_esg_cluster | analysis_date    | date        |\n|  52 | superset        | public         | raw_esg_cluster | analysis_week    | bigint      |\n|  53 | superset        | public         | raw_esg_cluster | cluster_id       | bigint      |\n|  54 | superset        | public         | raw_esg_cluster | probability      | bigint      |\n|  55 | superset        | public         | raw_esg_cluster | cluster_size     | bigint      |\n| 511 | superset        | public         | raw_esg_cluster | title            | text        |\n| 512 | superset        | public         | raw_esg_cluster | snippet          | text        |\n| 513 | superset        | public         | raw_esg_cluster | domain           | text        |\n| 514 | superset        | public         | raw_esg_cluster | url              | text        |\n| 515 | superset        | public         | raw_esg_cluster | sentiment        | text        |\n| 516 | superset        | public         | raw_esg_cluster | page_type        | text        |\n| 517 | superset        | public         | raw_esg_cluster | language         | text        |\n| 518 | superset        | public         | raw_esg_cluster | continent        | text        |\n| 519 | superset        | public         | raw_esg_cluster | country          | text        |\n| 523 | superset        | public         | raw_esg_cluster | summary          | text        |\n| 524 | superset        | public         | raw_esg_cluster | category_details | ARRAY       |\n| 526 | superset        | public         | raw_esg_cluster | resourceId       | text        |\n| 536 | superset        | public         | raw_esg_cluster | analysis_month   | text        |\n\nThis is a Postgres database\n\n'}, {'role': 'user', 'content': '2024년 ESG 소셜 데이터의 4월 전체, online_news, sov를 알려주고 전월대비 증감량을 비율로 알려줘.'}, {'role': 'assistant', 'content': "select analysis_month, sum(total), sum(online_news), sum((total - online_news)) as sns,  from raw_esg_volume where analysis_month in ('2024-03', '2024-04') group by analysis_month;"}, {'role': 'user', 'content': '2024년 4월 ESG 소셜 데이터의 전체 건수와 Environmental, Social, Governance의 전월 대비 증가량을 퍼센트로 알려줘.'}, {'role': 'assistant', 'content': "\n            select * from esg_monthly_change_analysis where category in ('Total', 'Environmental', 'Social', 'Governance') and current_month = '2024-04';\n        "}, {'role': 'user', 'content': '2024년 동안의 ESG 소셜 데이터의 월간 추세를 알려줘'}, {'role': 'assistant', 'content': "select analysis_month, category, summary, volume from proc_esg_monthly_summary where analysis_month like '2024%'"}, {'role': 'user', 'content': '2024년 1월 동안의 ESG 소셜 데이터의 주간 추세를 알려줘'}, {'role': 'assistant', 'content': "select analysis_week, category, summary, volume from proc_esg_weekly_summary where analysis_month = '2024-01'"}, {'role': 'user', 'content': 'ESG 소셜 데이터의 2024년 4월 브랜드 SOV 1위가 누군지 비율은 얼마인지 전월 대비 비율의 증감량이 얼마인지 알려줘.'}, {'role': 'assistant', 'content': "\n            SELECT brand,\n                SUM(volume) AS total_volume,\n                SUM(volume) * 100.0 / (SELECT SUM(volume) FROM esg_brand_volume WHERE analysis_month = '2024-04') AS sov_ratio,\n                (SUM(volume) - COALESCE((SELECT SUM(volume) FROM esg_brand_volume WHERE analysis_month = '2024-03' AND brand = e.brand), 0)) * 100.0\n                / COALESCE((SELECT SUM(volume) FROM esg_brand_volume WHERE analysis_month = '2024-03' AND brand = e.brand), 1) AS change_percentage\n            FROM esg_brand_volume e\n            WHERE analysis_month = '2024-04'\n            GROUP BY brand\n            ORDER BY total_volume DESC\n            LIMIT 1;\n        "}, {'role': 'user', 'content': '2024년 4월 ESG 소셜 데이터의 주요 키워드를 word cloud 차트를 표시해줘.'}, {'role': 'assistant', 'content': "\n            WITH raw_data AS (SELECT title || ' ' || summary AS text FROM public.raw_esg_cluster where analysis_month = '2024-04'),\n            split_words AS (SELECT unnest(string_to_array(lower(text), ' ')) AS word FROM raw_data),\n            cleaned_words AS (SELECT word FROM split_words WHERE word NOT IN (SELECT word FROM stop_words))\n            SELECT word, COUNT(*) as frequency\n            FROM cleaned_words\n            GROUP BY word\n            ORDER BY frequency desc\n        "}, {'role': 'user', 'content': '2024년 3월에 있었던 주요 기사를 알려줘'}, {'role': 'assistant', 'content': "\n            SELECT analysis_date, analysis_month, analysis_week, title, summary, url, sentiment, cluster_size\n            FROM (\n                SELECT *,\n                    ROW_NUMBER() OVER (PARTITION BY cluster_id, analysis_week) as rn\n                FROM raw_esg_cluster\n                WHERE analysis_month = '2024-03' and page_type = 'news' and cluster_id is not NULL\n            ) subquery\n            WHERE rn <= 1\n            order by cluster_size desc\n        "}, {'role': 'user', 'content': '2024년 4월 ESG 소셜 데이터의 주요 키워드 Top 3를 알려주고 내용을 요약해줘.'}, {'role': 'assistant', 'content': "\n            SELECT *\n            FROM (\n                SELECT DISTINCT ON (summary) *\n                FROM proc_esg_monthly_summary\n                WHERE analysis_month = '2024-04' AND volume IS NOT NULL\n                ORDER BY summary, volume DESC\n            ) subquery\n            ORDER BY volume DESC\n            LIMIT 3;\n        "}, {'role': 'user', 'content': 'esg 소셜 데이터 중 환경, 사회, 거버넌스 주제에 대해 주간 별 언급횟수 추이와 함께 ESG 소셜 \u200b\u200b데이터의 주제별 기사를 주간 별 및 카테고리 별로 요약한 내용을 보여줘.'}, {'role': 'assistant', 'content': 'SELECT analysis_month, analysis_week, category, summary, cluster_size, probability, volume FROM public.proc_esg_weekly_summary'}, {'role': 'user', 'content': '2024년 17째 주의 Social 카테고리의 기사 top5를 알려줘'}, {'role': 'assistant', 'content': "\n            SELECT distinct on (snippet, cluster_size) *\n            FROM raw_esg_cluster\n            WHERE analysis_week = 17 AND 'Social' = ANY (category_details)\n            ORDER BY cluster_size DESC LIMIT 5;\n        "}, {'role': 'user', 'content': '2024년 ESG 소셜 데이터의 4월 전체, online_news, sov를 알려주고 전월대비 증감량을 비율로 알려줘.'}]
Using model gpt-4o-2024-08-06 for 13186.75 tokens (approx)
SELECT 
    '2024-04' AS month,
    SUM(total) AS total_current,
    SUM(online_news) AS online_news_current,
    SUM(sov) AS sov_current,
    (SUM(total) - COALESCE(LAG(SUM(total)) OVER (ORDER BY analysis_month), 0)) * 100.0 / COALESCE(LAG(SUM(total)) OVER (ORDER BY analysis_month), 1) AS total_change_percentage,
    (SUM(online_news) - COALESCE(LAG(SUM(online_news)) OVER (ORDER BY analysis_month), 0)) * 100.0 / COALESCE(LAG(SUM(online_news)) OVER (ORDER BY analysis_month), 1) AS online_news_change_percentage,
    (SUM(sov) - COALESCE(LAG(SUM(sov)) OVER (ORDER BY analysis_month), 0)) * 100.0 / COALESCE(LAG(SUM(sov)) OVER (ORDER BY analysis_month), 1) AS sov_change_percentage
FROM 
    raw_esg_volume
WHERE 
    analysis_month IN ('2024-03', '2024-04')
GROUP BY 
    analysis_month
ORDER BY 
    analysis_month DESC
LIMIT 1;
Output from LLM: SELECT 
    '2024-04' AS month,
    SUM(total) AS total_current,
    SUM(online_news) AS online_news_current,
    SUM(sov) AS sov_current,
    (SUM(total) - COALESCE(LAG(SUM(total)) OVER (ORDER BY analysis_month), 0)) * 100.0 / COALESCE(LAG(SUM(total)) OVER (ORDER BY analysis_month), 1) AS total_change_percentage,
    (SUM(online_news) - COALESCE(LAG(SUM(online_news)) OVER (ORDER BY analysis_month), 0)) * 100.0 / COALESCE(LAG(SUM(online_news)) OVER (ORDER BY analysis_month), 1) AS online_news_change_percentage,
    (SUM(sov) - COALESCE(LAG(SUM(sov)) OVER (ORDER BY analysis_month), 0)) * 100.0 / COALESCE(LAG(SUM(sov)) OVER (ORDER BY analysis_month), 1) AS sov_change_percentage
FROM 
    raw_esg_volume
WHERE 
    analysis_month IN ('2024-03', '2024-04')
GROUP BY 
    analysis_month
ORDER BY 
    analysis_month DESC
LIMIT 1; 
Extracted SQL: SELECT 
    '2024-04' AS month,
    SUM(total) AS total_current,
    SUM(online_news) AS online_news_current,
    SUM(sov) AS sov_current,
    (SUM(total) - COALESCE(LAG(SUM(total)) OVER (ORDER BY analysis_month), 0)) * 100.0 / COALESCE(LAG(SUM(total)) OVER (ORDER BY analysis_month), 1) AS total_change_percentage,
    (SUM(online_news) - COALESCE(LAG(SUM(online_news)) OVER (ORDER BY analysis_month), 0)) * 100.0 / COALESCE(LAG(SUM(online_news)) OVER (ORDER BY analysis_month), 1) AS online_news_change_percentage,
    (SUM(sov) - COALESCE(LAG(SUM(sov)) OVER (ORDER BY analysis_month), 0)) * 100.0 / COALESCE(LAG(SUM(sov)) OVER (ORDER BY analysis_month), 1) AS sov_change_percentage
FROM 
    raw_esg_volume
WHERE 
    analysis_month IN ('2024-03', '2024-04')
GROUP BY 
    analysis_month
ORDER BY 
    analysis_month DESC
LIMIT 1;
Using model gpt-4o-2024-08-06 for 278.75 tokens (approx)
INFO:     127.0.0.1:53272 - "POST /generate_summary/ HTTP/1.1" 200 OK
Using model gpt-4o-2024-08-06 for 640.75 tokens (approx)
INFO:     127.0.0.1:58704 - "POST /generate_followup_questions/ HTTP/1.1" 200 OK
